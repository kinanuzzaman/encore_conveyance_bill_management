import{_ as c,o as i,a as l,f as a,a6 as r,a5 as d,bm as h,E as f,a7 as g,e as m,ae as y,Q as b}from"./index.5b2acc78.js";import{Q as O,b as S}from"./selection.9088e168.js";import{b as _}from"./QSelect.fbaf293c.js";import{A as $}from"./api-service.e4a3f494.js";const v={data(){return{searchQuery:"",suggestedOptions:[],selectedOption:null,loadingOptions:!1,datas:[],apiService:new $}},props:{api:{type:String,required:!1},label:{type:String,required:!0},userType:{type:String,enum:["CLIENT","VENDOR"],required:!1},searchOnly:{type:Boolean,default:!1},disable:{type:Boolean,default:!1},createApi:{type:String,required:!1},data:{type:Object,required:!1}},watch:{selectedOption:{handler:function(e){console.log("Selected option:",e),e&&e.value&&this.$emit("selected",e.value)},deep:!0}},methods:{onOptionSelect(e){console.log("Selected option:",e),this.$emit("selected",e)},onFilter(e){this.searchQuery=e,e.length>=1?this.fetchSuggestions(this.searchQuery):this.fetchSuggestions()},async fetchSuggestions(e){try{if(this.loadingOptions=!0,!this.$props.api&&!this.$props.createApi)return;const s=this.$props.createApi?this.$props.createApi:this.$props.api;let o={q:e};this.$props.userType&&(o.user_type=this.$props.userType,o.showAll=!0);const p=await this.apiService.get(s,{params:o});this.suggestedOptions=p.data.data.map(t=>({label:t.title||t.first_name+" "+t.last_name,value:t._id})),this.loadingOptions=!1}catch(s){console.log(s),this.loadingOptions=!1}},async requestNewData(){try{let e={title:this.searchQuery,isRequested:!0};this.$props.userType&&(e={user_type:this.$props.userType,name:this.searchQuery});const s=this.$props.createApi||`/${this.$props.api}/create`;await this.apiService.post(s,e),await this.fetchSuggestions()}catch(e){this.$q.notify({color:"negative",message:e.response?e.response.data.message:e.message,position:"top",icon:"report_problem"})}}},mounted(){this.$props.data&&(this.selectedOption=this.$props.data),this.fetchSuggestions()},computed:{noOptionsLabel(){return this.loadingOptions?"Loading options...":"No options available"}}},Q={key:0,class:"flex items-center justify-between w-full"},w={key:1};function q(e,s,o,p,t,n){return i(),l("div",null,[a(_,{disable:e.$props.disable,modelValue:t.selectedOption,"onUpdate:modelValue":s[1]||(s[1]=u=>t.selectedOption=u),label:`${e.$props.label}`,dense:"",outlined:"","option-label":"label","option-value":"value",options:t.suggestedOptions,"use-input":"",onInputValue:n.onFilter,loading:t.loadingOptions,"no-options-label":n.noOptionsLabel},{append:r(()=>[t.selectedOption?(i(),d(f,{key:0,name:"close",onClick:s[0]||(s[0]=h(u=>t.selectedOption=null,["stop","prevent"])),class:"cursor-pointer"})):g("",!0)]),"no-option":r(()=>[a(O,null,{default:r(()=>[a(S,null,{default:r(()=>[!e.$props.searchOnly&&t.searchQuery!==""?(i(),l("div",Q,[m("span",null,y(t.searchQuery),1),a(b,{color:"primary",icon:"add",label:"Add","no-caps":"",outline:"",unelevated:"",onClick:n.requestNewData},null,8,["onClick"])])):(i(),l("div",w," No results found. "))]),_:1})]),_:1})]),_:1},8,["disable","modelValue","label","options","onInputValue","loading","no-options-label"])])}var B=c(v,[["render",q]]);export{B as S};
