import{_ as g,aI as A,a3 as E,at as f,$ as _,a4 as P,o as v,a as h,e as S,f as l,a6 as c,ay as R,aw as p,ad as x,a8 as w,a7 as b,aH as k,a5 as q,Q as C}from"./index.5b2acc78.js";import{b as B}from"./QSelect.fbaf293c.js";import{A as O}from"./api-service.e4a3f494.js";import{S as V}from"./SearchAddCompo.f8c630c2.js";import{u as L}from"./use-quasar.b612f3c1.js";import{u as N}from"./auth.store.b2378202.js";import"./selection.9088e168.js";import"./format.2a3572e1.js";import"./axios.33769ef8.js";const M={components:{SearchAddCompo:V},setup(){const r=A(),e=E(),u=new O,a=N(),y=L(),i=f({label:null,value:null}),t=f({amount:null,payer:null,type:null}),d=[{label:"Product Purchase",value:"ProductPurchase",type:"PRODUCT_PURCHASE"},{label:"Office",value:"OfficeExpense",type:"OFFICE"},{label:"Delivery",value:"DeliveryExp",type:"DELIVERY"},{label:"Conveyance",value:"ConveyanceExp",type:"CONVINCE"},{label:"Factory",value:"FactoryExp",type:"FACTORY"},{label:"BP",value:"BpExp",type:"BP"},{label:"Labour",value:"LabourExp",type:"LABOUR"},{label:"Marketing",value:"MarketingExp",type:"MARKETING"},{label:"Mobile Allowance",value:"MobileAllowance",type:"MOBILE_ALLOWANCE"},{label:"Salary Request",value:"SalaryExp",type:"SALARY"},{label:"Other",value:"OtherBill",type:"OTHERS"}],s=async()=>{if(!navigator.geolocation){y.notify({message:"Allow Geolocation, or you can't continue",color:"red",position:"top"});return}navigator.geolocation.getCurrentPosition(async o=>{try{const{latitude:n,longitude:m}=o.coords;r.query.id?(await u.patch(`/cash-control/${r.query.id}`,{...t,type:t.type.type}),e.back()):(t.creator_location={latitude:n,longitude:m},await u.post("/cash-control/create",{...t,type:t.type.type}),e.back())}catch(n){y.notify({message:n.message,color:"negative",position:"top",timeout:2e3})}})};return _(async()=>{if(r.query.id){const o=await u.get(`/cash-control/${r.query.id}`);if(console.log("\u{1F680} ~ file: NewCashRequest.vue:140 ~ onRequest ~ data:",o.data.data),o.data.data){const n=d.find(m=>m.type==o.data.data[0].type);n&&(t.type=n,t.amount=o.data.data[0].amount,t.payer=o.data.data[0].payer._id,i.label=o.data.data[0].payer.first_name+" "+o.data.data[0].payer.last_name,i.value=o.data.data[0].payer._id,console.log(o))}}}),{cashPayload:t,saveCashRequest:s,options:d,payerData:i,authStore:a}}},Q={class:"q-px-md"},I={key:0,class:"grid md:grid-cols-2 grid-cols-1"};function D(r,e,u,a,y,i){const t=P("SearchAddCompo");return v(),h("div",null,[S("section",Q,[l(R,{flat:"",class:"h-[85vh] bg-transparent w-1/2"},{default:c(()=>{var d;return[l(p,{class:"text-center text-4xl font-bold"},{default:c(()=>[x(" Cash Request ")]),_:1}),l(p,null,{default:c(()=>[l(B,{class:"bg-white",outlined:"",modelValue:a.cashPayload.type,"onUpdate:modelValue":e[0]||(e[0]=s=>a.cashPayload.type=s),options:a.options,dense:!0,label:"Choose cash request type"},null,8,["modelValue","options"])]),_:1}),((d=a.cashPayload.type)==null?void 0:d.type)!=="SALARY"?(v(),h("div",I,[l(p,null,{default:c(()=>[l(w,{outlined:"",modelValue:a.cashPayload.amount,"onUpdate:modelValue":e[1]||(e[1]=s=>a.cashPayload.amount=s),placeholder:"Amount","bg-color":"white",dense:!0},null,8,["modelValue"])]),_:1}),l(p,null,{default:c(()=>[l(t,{data:a.payerData,label:"Paid By",api:"/users/?user_type=EMPLOYEE",onSelected:e[2]||(e[2]=s=>a.cashPayload.payer=s),"v-model":a.cashPayload.payer},null,8,["data","v-model"])]),_:1})])):b("",!0),l(k,{align:"center",class:"px-3 py-5 absolute bottom-0 w-full"},{default:c(()=>[a.authStore.canAccess("cash_write")?(v(),q(C,{key:0,label:"Save",color:"green",class:"col",onClick:a.saveCashRequest},null,8,["onClick"])):b("",!0),l(C,{label:"Back",color:"negative",class:"col",onClick:e[3]||(e[3]=s=>r.$router.back())})]),_:1})]}),_:1})])])}var z=g(M,[["render",D]]);export{z as default};
